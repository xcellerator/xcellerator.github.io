<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Posts :: TheXcellerator</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="" />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/posts/" />




<link rel="stylesheet" href="/assets/style.css">

  <link rel="stylesheet" href="/assets/blue.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="/img/favicon/blue.png">



<meta name="twitter:card" content="summary" />

<meta name="twitter:creator" content="" />


<meta property="og:locale" content="en" />
<meta property="og:type" content="website" />
<meta property="og:title" content="Posts :: TheXcellerator">
<meta property="og:description" content="" />
<meta property="og:url" content="/posts/" />
<meta property="og:site_name" content="Posts" />

  
    <meta property="og:image" content="/img/favicon/blue.png">
  

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">





  <link href="/posts/index.xml" rel="alternate" type="application/rss+xml" title="TheXcellerator" />









</head>
<body class="">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    TheXcellerator
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/categories/cryptography/">Cryptography</a></li>
        
      
        
          <li><a href="/categories/linux/">Linux</a></li>
        
      
        
          <li><a href="/categories/other/">Other</a></li>
        
      
        
          <li><a href="/categories/reverse_engineering/">Reverse Engineering</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/categories/cryptography/">Cryptography</a></li>
      
    
      
        <li><a href="/categories/linux/">Linux</a></li>
      
    
      
        <li><a href="/categories/other/">Other</a></li>
      
    
      
        <li><a href="/categories/reverse_engineering/">Reverse Engineering</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="posts">
  
  

  
  
  

  
  <div class="post on-list">
    <h1 class="post-title">
      <a href="/posts/linux_rootkits_07/">Linux Rootkits Part 7: Hiding Processes</a></h1>
    <div class="post-meta">
      <span class="post-date">
        2020-10-01
      </span>
      <span class="post-author">::
        TheXcellerator</span>
    </div>

    
    <span class="post-tags">
      
      #<a href="/tags/linux/">linux</a>&nbsp;
      
      #<a href="/tags/rootkit/">rootkit</a>&nbsp;
      
      #<a href="/tags/stealth/">stealth</a>&nbsp;
      
      #<a href="/tags/processes/">processes</a>&nbsp;
      
    </span>
    

    

    <div class="post-content">
      
      
      Now that we know how to hide directories (see last time), we can also hide processes! This is because nearly all userspace tools that give us information about processes just read the contents of the /proc/ filesystem. We can check this by looking at the output of strace -e openat ps or strace -e openat top. So, if we hide directories with the name of the PID we want to keep secret, then these userspace tools won’t notice that the process is there!
      
      
    </div>

    
    <div>
      <a class="read-more button"
        href="/posts/linux_rootkits_07/">Read more →</a>
    </div>
    
  </div>
  
  <div class="post on-list">
    <h1 class="post-title">
      <a href="/posts/docker_escape/">Privileged Container Escapes with Kernel Modules</a></h1>
    <div class="post-meta">
      <span class="post-date">
        2020-09-27
      </span>
      <span class="post-author">::
        TheXcellerator</span>
    </div>

    
    <span class="post-tags">
      
      #<a href="/tags/linux/">linux</a>&nbsp;
      
      #<a href="/tags/privileged/">privileged</a>&nbsp;
      
      #<a href="/tags/docker/">docker</a>&nbsp;
      
      #<a href="/tags/container/">container</a>&nbsp;
      
      #<a href="/tags/escape/">escape</a>&nbsp;
      
    </span>
    

    

    <div class="post-content">
      
      
      In all the playing around I’ve been doing with Linux kernel modules, I decided to see what would happen if you tried to load one from a Docker container. It turns out that privileged containers (or just those with CAP_SYS_MODULE) are able to use the sys_init_module() and sys_finit_module() syscalls - which are what’s used to load kernel modules. As all containers share their kernel with the host (unlike VMs), this clearly results in yet another complete system compromise.
      
      
    </div>

    
    <div>
      <a class="read-more button"
        href="/posts/docker_escape/">Read more →</a>
    </div>
    
  </div>
  
  <div class="post on-list">
    <h1 class="post-title">
      <a href="/posts/linux_rootkits_06/">Linux Rootkits Part 6: Hiding Directories</a></h1>
    <div class="post-meta">
      <span class="post-date">
        2020-09-19
      </span>
      <span class="post-author">::
        TheXcellerator</span>
    </div>

    
    <span class="post-tags">
      
      #<a href="/tags/linux/">linux</a>&nbsp;
      
      #<a href="/tags/rootkit/">rootkit</a>&nbsp;
      
      #<a href="/tags/stealth/">stealth</a>&nbsp;
      
      #<a href="/tags/directories/">directories</a>&nbsp;
      
    </span>
    

    

    <div class="post-content">
      
      
      At this point, we’ve used several different techniques to manipulate the kernel into doing interesting things. We’re going to combine a few of these techniques now in order to hide certain files and directories from userspace. This post is probably the most intricate yet due to the fact that we have to manipulate the structure returned by the kernel to userspace.
Roughly speaking, directory listing is handled by the syscall sys_getdents64 and its 32-bit counterpart sys_getdents (we’ll want to hook both, but they are identical except for a small addition in the 32-bit version).
      
      
    </div>

    
    <div>
      <a class="read-more button"
        href="/posts/linux_rootkits_06/">Read more →</a>
    </div>
    
  </div>
  
  <div class="pagination">
  <div class="pagination__buttons">
    
    
      <span class="button next">
        <a href="/posts/page/2/">
          <span class="button__text">Older posts</span>
          <span class="button__icon">→</span>
        </a>
      </span>
    
  </div>
</div>

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">
        <span>Harvey Phillips 2020 - London, England</span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>





  
</div>

</body>
</html>
