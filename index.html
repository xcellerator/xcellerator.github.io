<!DOCTYPE html>
<html lang="en">
<head>
	<meta name="generator" content="Hugo 0.88.1" />
  
    <title>TheXcellerator</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="" />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/" />




<link rel="stylesheet" href="/assets/style.css">

  <link rel="stylesheet" href="/assets/blue.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="/img/favicon/blue.png">



<meta name="twitter:card" content="summary" />

<meta name="twitter:creator" content="TheXcellerator" />


<meta property="og:locale" content="en" />
<meta property="og:type" content="website" />
<meta property="og:title" content="TheXcellerator">
<meta property="og:description" content="" />
<meta property="og:url" content="/" />
<meta property="og:site_name" content="TheXcellerator" />

  
    <meta property="og:image" content="/img/favicon/blue.png">
  

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">





  <link href="/index.xml" rel="alternate" type="application/rss+xml" title="TheXcellerator" />









</head>
<body class="">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    TheXcellerator
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/categories/cryptography/">Cryptography</a></li>
        
      
        
          <li><a href="/categories/linux/">Linux</a></li>
        
      
        
          <li><a href="/categories/other/">Other</a></li>
        
      
        
          <li><a href="/categories/reverse_engineering/">Reverse Engineering</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/categories/cryptography/">Cryptography</a></li>
      
    
      
        <li><a href="/categories/linux/">Linux</a></li>
      
    
      
        <li><a href="/categories/other/">Other</a></li>
      
    
      
        <li><a href="/categories/reverse_engineering/">Reverse Engineering</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="posts">
  
  

  
  
    
  
  

  
  <div class="post on-list">
    <h1 class="post-title">
      <a href="/posts/bggp21/">Janus: A Polyglot Binary for BGGP 2021</a></h1>
    <div class="post-meta">
      <span class="post-date">
        2021-09-16
      </span>
      
    </div>

    

    

    <div class="post-content">
      
      
      This year, @netspooky announced another round of the Binary Golf Grand Prix. If you missed it last year, the challenge was to create a palindromic binary - you can see the writeup of my entry, BootNoodle, here. This time around, the theme was polyglots, i.e. the challenge was to create a binary (as small as possible - hence the Golf part…) that was simulateously another filetype.
The rules were laid out very clearly into 2 categories: first - the smallest file that satisfied all the rules wins; second - rack up points by overlapping more and more filetypes with the bytes of your host binary.
      
      
    </div>

    
    <div>
      <a class="read-more button"
        href="/posts/bggp21/">Read more →</a>
    </div>
    
  </div>
  
  <div class="post on-list">
    <h1 class="post-title">
      <a href="/posts/linux_rootkits_11/">Linux Rootkits: New Methods for Kernel 5.7+</a></h1>
    <div class="post-meta">
      <span class="post-date">
        2021-01-11
      </span>
      <span class="post-author">::
        TheXcellerator</span>
    </div>

    
    <span class="post-tags">
      
      #<a href="/tags/linux/">linux</a>&nbsp;
      
      #<a href="/tags/rootkit/">rootkit</a>&nbsp;
      
      #<a href="/tags/kernel-5.7/">kernel 5.7</a>&nbsp;
      
    </span>
    

    

    <div class="post-content">
      
      
      What’s Going On? Back in February 2020, there were some stirrings on the LKML about unexporting kallsyms_lookup_name() from the kernel. The main reason for this is that unscrupulous module developers will often simply add MODULE_LICENSE(&lsquo;GPL&rsquo;) to their code (without actually licensing their module as such). Then, using kallsyms_lookup_name(), they can use any other exported kernel function to their heart’s content. The kernel developers don’t like this because it enables out-of-tree modules to call non-exported functions.
      
      
    </div>

    
    <div>
      <a class="read-more button"
        href="/posts/linux_rootkits_11/">Read more →</a>
    </div>
    
  </div>
  
  <div class="post on-list">
    <h1 class="post-title">
      <a href="/posts/linux_rootkits_10/">Fancy Bear&rsquo;s a Lumberjack and It&rsquo;s Okay - A Dive into the Kernel Component of Drovorub</a></h1>
    <div class="post-meta">
      <span class="post-date">
        2020-10-29
      </span>
      <span class="post-author">::
        TheXcellerator</span>
    </div>

    
    <span class="post-tags">
      
      #<a href="/tags/linux/">linux</a>&nbsp;
      
      #<a href="/tags/rootkit/">rootkit</a>&nbsp;
      
      #<a href="/tags/drovorub/">drovorub</a>&nbsp;
      
      #<a href="/tags/fancy-bear/">fancy bear</a>&nbsp;
      
    </span>
    

    

    <div class="post-content">
      
      
      What’s In A Name? Back in August, the NSA and FBI jointly issued a Cybersecurity Advisory on a previously undisclosed piece of malware developed by the Russian GRU called “Drovorub” - a name that comes from the Russian words “дрово” and “руб”, which together translate to “woodcutter” or, as I’m taking it, “lumberjack”.
What made this particular malware more interesting than usual is that it included a kernel module rootkit! In this post, I want to go through some of the techniques that this kernel module uses and how it relates to the techniques that we’ve already covered in other posts.
      
      
    </div>

    
    <div>
      <a class="read-more button"
        href="/posts/linux_rootkits_10/">Read more →</a>
    </div>
    
  </div>
  
  <div class="post on-list">
    <h1 class="post-title">
      <a href="/posts/bleeding_tooth/">Bleeding Tooth Deep Dive</a></h1>
    <div class="post-meta">
      <span class="post-date">
        2020-10-17
      </span>
      <span class="post-author">::
        TheXcellerator</span>
    </div>

    
    <span class="post-tags">
      
      #<a href="/tags/linux/">linux</a>&nbsp;
      
      #<a href="/tags/information-leak/">information leak</a>&nbsp;
      
      #<a href="/tags/bleedingtooth/">bleedingtooth</a>&nbsp;
      
      #<a href="/tags/bluetooth/">bluetooth</a>&nbsp;
      
    </span>
    

    

    <div class="post-content">
      
      
      A few days ago, Google’s research team published an information leak vulnerability in the Linux bluetooth stack along with a very nice poc.
In this post, I want to go through and dissect this poc to identify exactly what the vulnerability is and how it’s been fixed. This is the first kernel vulnerability that I’ve dove into deeply and I’ve found it to be surprisingly simple and straightforward.
The vulnerability itself, dubbed Bleeding Tooth by Google, is able to leak values from the kernel’s stack memory.
      
      
    </div>

    
    <div>
      <a class="read-more button"
        href="/posts/bleeding_tooth/">Read more →</a>
    </div>
    
  </div>
  
  <div class="post on-list">
    <h1 class="post-title">
      <a href="/posts/linux_rootkits_09/">Linux Rootkits Part 9: Hiding Logged In Users (Modifying File Contents Without Touching Disk)</a></h1>
    <div class="post-meta">
      <span class="post-date">
        2020-10-16
      </span>
      <span class="post-author">::
        TheXcellerator</span>
    </div>

    
    <span class="post-tags">
      
      #<a href="/tags/linux/">linux</a>&nbsp;
      
      #<a href="/tags/rootkit/">rootkit</a>&nbsp;
      
      #<a href="/tags/stealth/">stealth</a>&nbsp;
      
      #<a href="/tags/logged-in/">logged in</a>&nbsp;
      
      #<a href="/tags/users/">users</a>&nbsp;
      
    </span>
    

    

    <div class="post-content">
      
      
      Let’s see if we can hide the fact that a user is logged in! The idea is that we’ll be able to spawn a shell or login in as some user (we’ll choose root) and not have it show up in the output of tools like who or finger.
Looking at the output of who, we see a list of all the active terminal devices and the users associated to them.
      
      
    </div>

    
    <div>
      <a class="read-more button"
        href="/posts/linux_rootkits_09/">Read more →</a>
    </div>
    
  </div>
  
  <div class="post on-list">
    <h1 class="post-title">
      <a href="/posts/linux_rootkits_08/">Linux Rootkits Part 8: Hiding Open Ports</a></h1>
    <div class="post-meta">
      <span class="post-date">
        2020-10-02
      </span>
      <span class="post-author">::
        TheXcellerator</span>
    </div>

    
    <span class="post-tags">
      
      #<a href="/tags/linux/">linux</a>&nbsp;
      
      #<a href="/tags/rootkit/">rootkit</a>&nbsp;
      
      #<a href="/tags/stealth/">stealth</a>&nbsp;
      
      #<a href="/tags/ports/">ports</a>&nbsp;
      
      #<a href="/tags/network/">network</a>&nbsp;
      
    </span>
    

    

    <div class="post-content">
      
      
      Most userspace system tools just parse and manipulate data from one or more files and present them nicely to STDOUT. We’ve already seen this with processes (see Part 7), but this time we’re going to do the same thing with open ports. By the end, we’ll be able to open a listener on port 8080 (any port would do) without it showing up in things like netstat.
Assuming that a file is being read from, we need to try to find out which one.
      
      
    </div>

    
    <div>
      <a class="read-more button"
        href="/posts/linux_rootkits_08/">Read more →</a>
    </div>
    
  </div>
  
  <div class="post on-list">
    <h1 class="post-title">
      <a href="/posts/linux_rootkits_07/">Linux Rootkits Part 7: Hiding Processes</a></h1>
    <div class="post-meta">
      <span class="post-date">
        2020-10-01
      </span>
      <span class="post-author">::
        TheXcellerator</span>
    </div>

    
    <span class="post-tags">
      
      #<a href="/tags/linux/">linux</a>&nbsp;
      
      #<a href="/tags/rootkit/">rootkit</a>&nbsp;
      
      #<a href="/tags/stealth/">stealth</a>&nbsp;
      
      #<a href="/tags/processes/">processes</a>&nbsp;
      
    </span>
    

    

    <div class="post-content">
      
      
      Now that we know how to hide directories (see last time), we can also hide processes! This is because nearly all userspace tools that give us information about processes just read the contents of the /proc/ filesystem. We can check this by looking at the output of strace -e openat ps or strace -e openat top. So, if we hide directories with the name of the PID we want to keep secret, then these userspace tools won’t notice that the process is there!
      
      
    </div>

    
    <div>
      <a class="read-more button"
        href="/posts/linux_rootkits_07/">Read more →</a>
    </div>
    
  </div>
  
  <div class="post on-list">
    <h1 class="post-title">
      <a href="/posts/docker_escape/">Privileged Container Escapes with Kernel Modules</a></h1>
    <div class="post-meta">
      <span class="post-date">
        2020-09-27
      </span>
      <span class="post-author">::
        TheXcellerator</span>
    </div>

    
    <span class="post-tags">
      
      #<a href="/tags/linux/">linux</a>&nbsp;
      
      #<a href="/tags/privileged/">privileged</a>&nbsp;
      
      #<a href="/tags/docker/">docker</a>&nbsp;
      
      #<a href="/tags/container/">container</a>&nbsp;
      
      #<a href="/tags/escape/">escape</a>&nbsp;
      
    </span>
    

    

    <div class="post-content">
      
      
      In all the playing around I’ve been doing with Linux kernel modules, I decided to see what would happen if you tried to load one from a Docker container. It turns out that privileged containers (or just those with CAP_SYS_MODULE) are able to use the sys_init_module() and sys_finit_module() syscalls - which are what’s used to load kernel modules. As all containers share their kernel with the host (unlike VMs), this clearly results in yet another complete system compromise.
      
      
    </div>

    
    <div>
      <a class="read-more button"
        href="/posts/docker_escape/">Read more →</a>
    </div>
    
  </div>
  
  <div class="post on-list">
    <h1 class="post-title">
      <a href="/posts/linux_rootkits_06/">Linux Rootkits Part 6: Hiding Directories</a></h1>
    <div class="post-meta">
      <span class="post-date">
        2020-09-19
      </span>
      <span class="post-author">::
        TheXcellerator</span>
    </div>

    
    <span class="post-tags">
      
      #<a href="/tags/linux/">linux</a>&nbsp;
      
      #<a href="/tags/rootkit/">rootkit</a>&nbsp;
      
      #<a href="/tags/stealth/">stealth</a>&nbsp;
      
      #<a href="/tags/directories/">directories</a>&nbsp;
      
    </span>
    

    

    <div class="post-content">
      
      
      At this point, we’ve used several different techniques to manipulate the kernel into doing interesting things. We’re going to combine a few of these techniques now in order to hide certain files and directories from userspace. This post is probably the most intricate yet due to the fact that we have to manipulate the structure returned by the kernel to userspace.
Roughly speaking, directory listing is handled by the syscall sys_getdents64 and its 32-bit counterpart sys_getdents (we’ll want to hook both, but they are identical except for a small addition in the 32-bit version).
      
      
    </div>

    
    <div>
      <a class="read-more button"
        href="/posts/linux_rootkits_06/">Read more →</a>
    </div>
    
  </div>
  
  <div class="post on-list">
    <h1 class="post-title">
      <a href="/posts/linux_rootkits_05/">Linux Rootkits Part 5: Hiding Kernel Modules from Userspace</a></h1>
    <div class="post-meta">
      <span class="post-date">
        2020-09-17
      </span>
      <span class="post-author">::
        TheXcellerator</span>
    </div>

    
    <span class="post-tags">
      
      #<a href="/tags/linux/">linux</a>&nbsp;
      
      #<a href="/tags/rootkit/">rootkit</a>&nbsp;
      
      #<a href="/tags/stealth/">stealth</a>&nbsp;
      
      #<a href="/tags/linked-lists/">linked lists</a>&nbsp;
      
    </span>
    

    

    <div class="post-content">
      
      
      So far, we’ve seen how hooking both syscalls and regular functions can be put to good use. But, seeing as how this is a series on rootkits, we should really be making some considerations on stealth. If you’ve been following along, then once you’d loaded any of the previous rootkits, it’s presence would have been revealed by simply examining the output of lsmod.
$ lsmod | grep rootkit rootkit 16384 0 Pretty obvious, right?
      
      
    </div>

    
    <div>
      <a class="read-more button"
        href="/posts/linux_rootkits_05/">Read more →</a>
    </div>
    
  </div>
  
  <div class="pagination">
  <div class="pagination__buttons">
    
    
      <span class="button next">
        <a href="/page/2/">
          <span class="button__text">Older posts</span>
          <span class="button__icon">→</span>
        </a>
      </span>
    
  </div>
</div>

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">
        <span>Harvey Phillips 2020 - London, England</span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>





  
</div>

</body>
</html>
